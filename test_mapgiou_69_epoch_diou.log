Traceback (most recent call last):
  File "test_mapgiou.py", line 9, in <module>
    import torch.nn.functional as F
ModuleNotFoundError: No module named 'torch'
Namespace(batch_size=8, cfg='cfg/yolov3_864x480.cfg', conf_thres=0.3, data_cfg='cfg/ccmcpe.json', iou_thres=0.5, nms_thres=0.5, print_interval=40, weights='../weights/69_epoch_diou.pt')

test giou...
loading data...
================================================================================
dataset summary
OrderedDict([('caltech', 1311.0), ('citypersons', 0)])
total # identities: 1312
start index
OrderedDict([('caltech', 0), ('citypersons', 1311.0)])
================================================================================
building model...
      Image      Total          P          R        mAP
Computing mAP...
          8      30353          0          0          0        1.1s
GIOU:     8      30353          0          0          0       1.11s
        328      30353      0.724      0.619      0.597      0.217s
GIOU:   328      30353       0.72      0.614      0.595      0.217s
        648      30353      0.739      0.573       0.56      0.206s
GIOU:   648      30353      0.729      0.566      0.553      0.206s
        968      30353      0.768      0.605      0.594      0.205s
GIOU:   968      30353       0.76      0.598      0.588      0.206s
       1288      30353      0.807      0.713      0.704      0.216s
GIOU:  1288      30353      0.802      0.708        0.7      0.216s
       1608      30353      0.816      0.741       0.73      0.232s
GIOU:  1608      30353       0.81      0.735      0.725      0.232s
       1928      30353      0.798      0.735      0.722      0.218s
GIOU:  1928      30353      0.792       0.73      0.717      0.218s
       2248      30353      0.793      0.739      0.725      0.207s
GIOU:  2248      30353      0.787      0.733       0.72      0.207s
       2568      30353      0.775      0.743      0.727      0.219s
GIOU:  2568      30353      0.769      0.737      0.721      0.219s
       2888      30353      0.772      0.744      0.727      0.229s
GIOU:  2888      30353      0.766      0.738       0.72      0.229s
       3208      30353      0.776      0.754      0.737      0.194s
GIOU:  3208      30353      0.768      0.747      0.729      0.194s
       3528      30353      0.782      0.761      0.743      0.239s
GIOU:  3528      30353      0.774      0.752      0.735      0.239s
       3848      30353       0.79      0.761      0.745      0.223s
GIOU:  3848      30353      0.781      0.752      0.736      0.223s
       4168      30353      0.796      0.772      0.755      0.216s
GIOU:  4168      30353      0.788      0.763      0.747      0.216s
       4488      30353      0.802       0.78      0.764      0.204s
GIOU:  4488      30353      0.795      0.772      0.756      0.204s
       4808      30353      0.806      0.774      0.759      0.225s
GIOU:  4808      30353      0.799      0.767      0.751      0.225s
       5128      30353      0.806      0.773      0.759      0.216s
GIOU:  5128      30353      0.799      0.766      0.751      0.216s
       5448      30353      0.801       0.76      0.746      0.227s
GIOU:  5448      30353      0.794      0.753      0.739      0.227s
       5768      30353      0.802      0.755      0.741      0.231s
GIOU:  5768      30353      0.795      0.748      0.734      0.231s
       6088      30353      0.811      0.754      0.741      0.239s
GIOU:  6088      30353      0.804      0.748      0.734      0.239s
       6408      30353       0.82      0.756      0.743      0.233s
GIOU:  6408      30353      0.813      0.749      0.736      0.233s
       6728      30353      0.822      0.757      0.744      0.239s
GIOU:  6728      30353      0.815       0.75      0.737      0.239s
       7048      30353      0.825      0.761      0.748       0.22s
GIOU:  7048      30353      0.818      0.754      0.741       0.22s
       7368      30353      0.831      0.763      0.751      0.239s
GIOU:  7368      30353      0.824      0.757      0.745      0.239s
       7688      30353      0.837      0.769      0.757      0.258s
GIOU:  7688      30353      0.831      0.763      0.751      0.258s
       8008      30353      0.841      0.776      0.764      0.231s
GIOU:  8008      30353      0.835       0.77      0.758      0.232s
       8328      30353      0.844      0.782       0.77      0.242s
GIOU:  8328      30353      0.838      0.776      0.764      0.243s
       8648      30353      0.847      0.783       0.77      0.261s
GIOU:  8648      30353      0.841      0.777      0.764      0.261s
       8968      30353      0.844      0.781      0.767      0.192s
GIOU:  8968      30353      0.838      0.774      0.761      0.192s
       9288      30353      0.845      0.784       0.77      0.254s
GIOU:  9288      30353      0.839      0.778      0.764      0.254s
       9608      30353      0.843      0.783       0.77      0.209s
GIOU:  9608      30353      0.837      0.777      0.764      0.209s
       9928      30353       0.84      0.778      0.765      0.247s
GIOU:  9928      30353      0.835      0.772      0.759      0.247s
      10248      30353      0.838      0.778      0.765       0.23s
GIOU: 10248      30353      0.833      0.773      0.759       0.23s
      10568      30353      0.841      0.783       0.77      0.253s
GIOU: 10568      30353      0.835      0.777      0.764      0.253s
      10888      30353      0.836      0.784       0.77      0.271s
GIOU: 10888      30353       0.83      0.778      0.763      0.271s
      11208      30353      0.829      0.785      0.769      0.269s
GIOU: 11208      30353      0.823      0.779      0.763       0.27s
      11528      30353      0.827      0.787      0.771      0.227s
GIOU: 11528      30353      0.821      0.781      0.764      0.227s
      11848      30353       0.83       0.79      0.774      0.209s
GIOU: 11848      30353      0.823      0.784      0.768      0.209s
      12168      30353      0.831      0.792      0.776      0.225s
GIOU: 12168      30353      0.825      0.785       0.77      0.225s
      12488      30353      0.834      0.794      0.779      0.268s
GIOU: 12488      30353      0.828      0.788      0.773      0.268s
      12808      30353      0.832      0.799      0.783      0.266s
GIOU: 12808      30353      0.826      0.792      0.777      0.266s
      13128      30353      0.834        0.8      0.785      0.251s
GIOU: 13128      30353      0.827      0.794      0.778      0.251s
      13448      30353      0.835      0.802      0.786      0.227s
GIOU: 13448      30353      0.829      0.795       0.78      0.227s
      13768      30353      0.836        0.8      0.785      0.281s
GIOU: 13768      30353       0.83      0.794      0.779      0.281s
      14088      30353      0.838        0.8      0.785      0.264s
GIOU: 14088      30353      0.831      0.794      0.779      0.265s
      14408      30353      0.829      0.793      0.778      0.211s
GIOU: 14408      30353      0.823      0.787      0.771      0.211s
      14728      30353      0.829      0.795      0.779      0.262s
GIOU: 14728      30353      0.823      0.788      0.773      0.262s
      15048      30353      0.831      0.796      0.781      0.242s
GIOU: 15048      30353      0.825       0.79      0.775      0.242s
      15368      30353      0.834      0.799      0.784      0.271s
GIOU: 15368      30353      0.828      0.793      0.778      0.271s
      15688      30353      0.835      0.801      0.786      0.267s
GIOU: 15688      30353      0.829      0.795       0.78      0.267s
      16008      30353      0.835      0.801      0.786      0.275s
GIOU: 16008      30353      0.829      0.795       0.78      0.275s
      16328      30353      0.838      0.804       0.79      0.272s
GIOU: 16328      30353      0.832      0.798      0.784      0.272s
      16648      30353      0.841      0.808      0.793      0.274s
GIOU: 16648      30353      0.835      0.802      0.787      0.274s
      16968      30353      0.844      0.812      0.798      0.274s
GIOU: 16968      30353      0.838      0.806      0.792      0.274s
      17288      30353      0.845      0.813      0.799      0.201s
GIOU: 17288      30353      0.839      0.807      0.793      0.201s
      17608      30353      0.846      0.814        0.8      0.289s
GIOU: 17608      30353      0.839      0.807      0.794      0.289s
      17928      30353      0.848      0.817      0.804      0.301s
GIOU: 17928      30353      0.841      0.811      0.797      0.301s
      18248      30353       0.85       0.82      0.807      0.281s
GIOU: 18248      30353      0.843      0.814      0.801      0.281s
      18568      30353       0.85      0.822      0.809      0.219s
GIOU: 18568      30353      0.844      0.815      0.802      0.219s
      18888      30353       0.85       0.82      0.808      0.233s
GIOU: 18888      30353      0.844      0.814      0.801      0.234s
      19208      30353      0.851      0.818      0.805      0.285s
GIOU: 19208      30353      0.845      0.811      0.798      0.285s
      19528      30353      0.852      0.817      0.804      0.324s
GIOU: 19528      30353      0.846       0.81      0.797      0.324s
      19848      30353      0.851      0.814      0.801      0.279s
GIOU: 19848      30353      0.845      0.808      0.795      0.279s
      20168      30353      0.852      0.815      0.802      0.211s
GIOU: 20168      30353      0.845      0.808      0.796      0.211s
      20488      30353      0.852      0.817      0.804      0.283s
GIOU: 20488      30353      0.846      0.811      0.798      0.283s
      20808      30353      0.853      0.819      0.807      0.276s
GIOU: 20808      30353      0.847      0.813        0.8      0.276s
      21128      30353      0.855      0.821      0.809      0.287s
GIOU: 21128      30353      0.849      0.815      0.803      0.288s
      21448      30353      0.857      0.823      0.811       0.22s
GIOU: 21448      30353       0.85      0.817      0.805       0.22s
      21768      30353      0.857      0.823      0.811      0.281s
GIOU: 21768      30353      0.851      0.817      0.805      0.281s
      22088      30353      0.856      0.823      0.811      0.221s
GIOU: 22088      30353       0.85      0.817      0.805      0.222s
      22408      30353      0.856      0.823      0.811      0.227s
GIOU: 22408      30353       0.85      0.817      0.805      0.227s
      22728      30353      0.856      0.824      0.812      0.289s
GIOU: 22728      30353       0.85      0.818      0.805      0.289s
      23048      30353      0.857      0.824      0.812      0.239s
GIOU: 23048      30353       0.85      0.818      0.806      0.239s
      23368      30353      0.854      0.822       0.81      0.276s
GIOU: 23368      30353      0.848      0.816      0.803      0.276s
      23688      30353      0.854      0.822       0.81      0.209s
GIOU: 23688      30353      0.848      0.815      0.803      0.209s
      24008      30353      0.854      0.822       0.81      0.302s
GIOU: 24008      30353      0.848      0.815      0.803      0.302s
      24328      30353      0.855      0.822       0.81      0.224s
GIOU: 24328      30353      0.848      0.816      0.804      0.224s
      24648      30353      0.854      0.821      0.809      0.317s
GIOU: 24648      30353      0.847      0.815      0.803      0.317s
      24968      30353      0.852      0.819      0.807      0.318s
GIOU: 24968      30353      0.846      0.813      0.801      0.318s
      25288      30353      0.851      0.816      0.804      0.275s
GIOU: 25288      30353      0.845       0.81      0.798      0.275s
      25608      30353      0.853      0.818      0.807      0.319s
GIOU: 25608      30353      0.847      0.812      0.801      0.319s
      25928      30353      0.854      0.819      0.808      0.241s
GIOU: 25928      30353      0.848      0.813      0.802      0.241s
      26248      30353      0.854       0.82      0.808      0.337s
GIOU: 26248      30353      0.848      0.814      0.802      0.337s
      26568      30353      0.853      0.819      0.807      0.302s
GIOU: 26568      30353      0.847      0.813      0.801      0.302s
      26888      30353      0.854      0.818      0.806      0.214s
GIOU: 26888      30353      0.848      0.812        0.8      0.214s
      27208      30353      0.854      0.817      0.805      0.291s
GIOU: 27208      30353      0.848      0.811      0.799      0.291s
      27528      30353      0.855      0.815      0.804      0.317s
GIOU: 27528      30353      0.848      0.809      0.798      0.317s
      27848      30353      0.855      0.815      0.803      0.193s
GIOU: 27848      30353      0.849      0.809      0.797      0.193s
      28168      30353      0.855      0.814      0.802      0.197s
GIOU: 28168      30353      0.849      0.808      0.796      0.197s
      28488      30353      0.854      0.813      0.801      0.298s
GIOU: 28488      30353      0.848      0.807      0.795      0.298s
      28808      30353      0.854      0.813      0.801      0.322s
GIOU: 28808      30353      0.848      0.807      0.795      0.322s
      29128      30353      0.855      0.813      0.801      0.324s
GIOU: 29128      30353      0.849      0.807      0.795      0.324s
      29448      30353      0.856      0.813      0.802      0.332s
GIOU: 29448      30353       0.85      0.807      0.796      0.332s
      29768      30353      0.856      0.811        0.8      0.298s
GIOU: 29768      30353       0.85      0.805      0.794      0.298s
      30088      30353      0.855      0.808      0.797       0.35s
GIOU: 30088      30353      0.849      0.802      0.791       0.35s
      Image      Total          P          R        mAP
AP: 0.7942


giou_AP: 0.7881


test.test:	 [0.79416357] 	 [0.80567034] 	 [0.85482034]
================================================================================
dataset summary
OrderedDict([('caltech', 393.0), ('cuhksysu', 11934.0), ('prw', 934.0)])
total # identities: 13262
start index
OrderedDict([('caltech', 0), ('cuhksysu', 393.0), ('prw', 12327.0)])
================================================================================
Extracting pedestrain features...
Extracting 0/1750, # of instances 16, time 0.30 sec.
Extracting 40/1750, # of instances 740, time 0.23 sec.
Extracting 80/1750, # of instances 1562, time 0.21 sec.
Extracting 120/1750, # of instances 2167, time 0.23 sec.
Extracting 160/1750, # of instances 2625, time 0.22 sec.
Extracting 200/1750, # of instances 3070, time 0.22 sec.
Extracting 240/1750, # of instances 3512, time 0.23 sec.
Extracting 280/1750, # of instances 4168, time 0.20 sec.
Extracting 320/1750, # of instances 4917, time 0.25 sec.
Extracting 360/1750, # of instances 5656, time 0.22 sec.
Extracting 400/1750, # of instances 6192, time 0.21 sec.
Extracting 440/1750, # of instances 6821, time 0.26 sec.
Extracting 480/1750, # of instances 7532, time 0.25 sec.
Extracting 520/1750, # of instances 8106, time 0.22 sec.
Extracting 560/1750, # of instances 8705, time 0.22 sec.
Extracting 600/1750, # of instances 9311, time 0.25 sec.
Extracting 640/1750, # of instances 9821, time 0.23 sec.
Extracting 680/1750, # of instances 10564, time 0.21 sec.
Extracting 720/1750, # of instances 11389, time 0.23 sec.
Extracting 760/1750, # of instances 12637, time 0.23 sec.
Extracting 800/1750, # of instances 13697, time 0.22 sec.
Extracting 840/1750, # of instances 14336, time 0.22 sec.
Extracting 880/1750, # of instances 14954, time 0.23 sec.
Extracting 920/1750, # of instances 15780, time 0.25 sec.
Extracting 960/1750, # of instances 16666, time 0.24 sec.
Extracting 1000/1750, # of instances 17354, time 0.24 sec.
Extracting 1040/1750, # of instances 18131, time 0.22 sec.
Extracting 1080/1750, # of instances 18969, time 0.24 sec.
Extracting 1120/1750, # of instances 19634, time 0.21 sec.
Extracting 1160/1750, # of instances 20204, time 0.25 sec.
Extracting 1200/1750, # of instances 20794, time 0.21 sec.
Extracting 1240/1750, # of instances 21232, time 0.23 sec.
Extracting 1280/1750, # of instances 21920, time 0.25 sec.
Extracting 1320/1750, # of instances 22726, time 0.26 sec.
Extracting 1360/1750, # of instances 23513, time 0.23 sec.
Extracting 1400/1750, # of instances 24322, time 0.25 sec.
Extracting 1440/1750, # of instances 25162, time 0.25 sec.
Extracting 1480/1750, # of instances 25946, time 0.26 sec.
Extracting 1520/1750, # of instances 26804, time 0.28 sec.
Extracting 1560/1750, # of instances 27687, time 0.26 sec.
Extracting 1600/1750, # of instances 28893, time 0.27 sec.
Extracting 1640/1750, # of instances 30190, time 0.26 sec.
Extracting 1680/1750, # of instances 31378, time 0.25 sec.
Extracting 1720/1750, # of instances 32483, time 0.25 sec.
Computing pairwise similairity...
33305 33305
Namespace(batch_size=8, cfg='cfg/yolov3_864x480.cfg', conf_thres=0.3, data_cfg='cfg/ccmcpe.json', iou_thres=0.5, nms_thres=0.5, print_interval=40, weights='../weights/69_epoch_diou.pt')

================================================================================
dataset summary
OrderedDict([('caltech', 393.0), ('cuhksysu', 11934.0), ('prw', 934.0)])
total # identities: 13262
start index
OrderedDict([('caltech', 0), ('cuhksysu', 393.0), ('prw', 12327.0)])
================================================================================
Extracting pedestrain features...
Extracting 0/1750, # of instances 16, time 0.66 sec.
Extracting 40/1750, # of instances 740, time 0.20 sec.
Extracting 80/1750, # of instances 1562, time 0.21 sec.
Extracting 120/1750, # of instances 2167, time 0.20 sec.
Extracting 160/1750, # of instances 2625, time 0.21 sec.
Extracting 200/1750, # of instances 3070, time 0.22 sec.
Extracting 240/1750, # of instances 3512, time 0.20 sec.
Extracting 280/1750, # of instances 4168, time 0.20 sec.
Extracting 320/1750, # of instances 4917, time 0.22 sec.
Extracting 360/1750, # of instances 5656, time 0.20 sec.
Extracting 400/1750, # of instances 6192, time 0.20 sec.
Extracting 440/1750, # of instances 6821, time 0.23 sec.
Extracting 480/1750, # of instances 7532, time 0.22 sec.
Extracting 520/1750, # of instances 8106, time 0.22 sec.
Extracting 560/1750, # of instances 8705, time 0.21 sec.
Extracting 600/1750, # of instances 9311, time 0.20 sec.
Extracting 640/1750, # of instances 9821, time 0.22 sec.
Extracting 680/1750, # of instances 10564, time 0.20 sec.
Extracting 720/1750, # of instances 11389, time 0.22 sec.
Extracting 760/1750, # of instances 12637, time 0.22 sec.
Extracting 800/1750, # of instances 13697, time 0.20 sec.
Extracting 840/1750, # of instances 14336, time 0.20 sec.
Extracting 880/1750, # of instances 14954, time 0.22 sec.
Extracting 920/1750, # of instances 15780, time 0.21 sec.
Extracting 960/1750, # of instances 16666, time 0.20 sec.
Extracting 1000/1750, # of instances 17354, time 0.20 sec.
Extracting 1040/1750, # of instances 18131, time 0.22 sec.
Extracting 1080/1750, # of instances 18969, time 0.22 sec.
Extracting 1120/1750, # of instances 19634, time 0.20 sec.
Extracting 1160/1750, # of instances 20204, time 0.22 sec.
Extracting 1200/1750, # of instances 20794, time 0.20 sec.
Extracting 1240/1750, # of instances 21232, time 0.21 sec.
Extracting 1280/1750, # of instances 21920, time 0.23 sec.
Extracting 1320/1750, # of instances 22726, time 0.23 sec.
Extracting 1360/1750, # of instances 23513, time 0.22 sec.
Extracting 1400/1750, # of instances 24322, time 0.24 sec.
Extracting 1440/1750, # of instances 25162, time 0.21 sec.
Extracting 1480/1750, # of instances 25946, time 0.22 sec.
Extracting 1520/1750, # of instances 26804, time 0.22 sec.
Extracting 1560/1750, # of instances 27687, time 0.25 sec.
Extracting 1600/1750, # of instances 28893, time 0.25 sec.
Extracting 1640/1750, # of instances 30190, time 0.27 sec.
Extracting 1680/1750, # of instances 31378, time 0.26 sec.
Extracting 1720/1750, # of instances 32483, time 0.23 sec.
Computing pairwise similairity...
33305 33305
TPR@FAR=0.0000010: 0.0264
TPR@FAR=0.0000100: 0.0606
TPR@FAR=0.0001000: 0.1263
TPR@FAR=0.0010000: 0.2492
TPR@FAR=0.0100000: 0.5296
TPR@FAR=0.1000000: 0.8557
