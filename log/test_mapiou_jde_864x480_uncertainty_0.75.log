Namespace(batch_size=8, cfg='cfg/yolov3_864x480.cfg', conf_thres=0.3, data_cfg='cfg/ccmcpe.json', iou_thres=0.75, nms_thres=0.5, print_interval=40, weights='../weights/jde_864x480_uncertainty.pt')

test giou...
loading data...
================================================================================
dataset summary
OrderedDict([('caltech', 1311.0), ('citypersons', 0)])
total # identities: 1312
start index
OrderedDict([('caltech', 0), ('citypersons', 1311.0)])
================================================================================
building model...
      Image      Total          P          R        mAP
Computing mAP...
          8      30353          0          0          0       7.53s
GIOU:     8      30353          0          0          0       7.53s
        328      30353      0.448      0.396      0.387      0.399s
GIOU:   328      30353      0.434      0.386      0.376       0.62s
        648      30353      0.485      0.351      0.346      0.264s
GIOU:   648      30353      0.476      0.344      0.338       1.06s
        968      30353      0.504      0.373      0.368      0.229s
GIOU:   968      30353      0.495      0.367      0.361       1.21s
       1288      30353      0.583      0.503      0.498      0.528s
GIOU:  1288      30353      0.576      0.498      0.492       1.53s
       1608      30353      0.575      0.508        0.5      0.422s
GIOU:  1608      30353      0.567      0.501      0.494        1.4s
       1928      30353      0.545      0.487      0.478       0.28s
GIOU:  1928      30353      0.535      0.479      0.471       1.32s
       2248      30353      0.527      0.474      0.463      0.239s
GIOU:  2248      30353      0.517      0.465      0.455       1.42s
       2568      30353      0.511      0.466      0.456      0.403s
GIOU:  2568      30353      0.502      0.459      0.448       1.52s
       2888      30353      0.504      0.459      0.448      0.413s
GIOU:  2888      30353      0.493      0.451       0.44       1.74s
       3208      30353       0.49       0.45      0.439      0.232s
GIOU:  3208      30353      0.478      0.439      0.428       1.38s
       3528      30353       0.49       0.45      0.439      0.334s
GIOU:  3528      30353      0.478       0.44      0.429       1.48s
       3848      30353      0.487      0.445      0.433      0.307s
GIOU:  3848      30353      0.475      0.434      0.423       1.45s
       4168      30353      0.501      0.464      0.452      0.247s
GIOU:  4168      30353      0.488      0.453      0.441       1.46s
       4488      30353       0.51      0.476      0.463      0.372s
GIOU:  4488      30353      0.497      0.465      0.452       1.53s
       4808      30353      0.508      0.469      0.456      0.337s
GIOU:  4808      30353      0.496      0.458      0.445       1.51s
       5128      30353      0.509      0.468      0.455      0.284s
GIOU:  5128      30353      0.498      0.458      0.445       1.55s
       5448      30353      0.497      0.454      0.441       0.19s
GIOU:  5448      30353      0.485      0.444      0.431       1.44s
       5768      30353      0.494      0.449      0.434      0.268s
GIOU:  5768      30353      0.481      0.438      0.423       1.44s
       6088      30353      0.497      0.448      0.432       0.42s
GIOU:  6088      30353      0.484      0.436      0.421       1.63s
       6408      30353      0.504      0.452      0.435      0.395s
GIOU:  6408      30353       0.49       0.44      0.423       1.67s
       6728      30353      0.512      0.458      0.441      0.264s
GIOU:  6728      30353      0.498      0.446      0.429       1.53s
       7048      30353      0.519      0.467      0.449      0.482s
GIOU:  7048      30353      0.505      0.455      0.437       1.73s
       7368      30353      0.524      0.472      0.454      0.253s
GIOU:  7368      30353       0.51       0.46      0.442       1.54s
       7688      30353      0.522      0.472      0.453      0.391s
GIOU:  7688      30353      0.508       0.46      0.441       1.62s
       8008      30353      0.518       0.47      0.451      0.422s
GIOU:  8008      30353      0.503      0.457      0.438       2.28s
       8328      30353      0.518      0.473      0.453      0.259s
GIOU:  8328      30353      0.503       0.46      0.439       1.47s
       8648      30353      0.518      0.472       0.45       0.25s
GIOU:  8648      30353      0.503      0.459      0.437       1.51s
       8968      30353      0.515      0.469      0.448      0.371s
GIOU:  8968      30353        0.5      0.456      0.434        1.6s
       9288      30353       0.51      0.465      0.444      0.273s
GIOU:  9288      30353      0.495      0.452       0.43       1.52s
       9608      30353      0.508      0.464      0.442      0.187s
GIOU:  9608      30353      0.494      0.452      0.429       1.46s
       9928      30353      0.511      0.466      0.444      0.419s
GIOU:  9928      30353      0.497      0.453      0.431       1.62s
      10248      30353      0.508      0.463      0.442      0.381s
GIOU: 10248      30353      0.493      0.451      0.429       1.62s
      10568      30353      0.504      0.461       0.44      0.269s
GIOU: 10568      30353       0.49      0.449      0.427       1.52s
      10888      30353      0.498      0.459      0.437      0.308s
GIOU: 10888      30353      0.484      0.447      0.425       1.43s
      11208      30353      0.493       0.46      0.437      0.274s
GIOU: 11208      30353       0.48      0.447      0.424       1.36s
      11528      30353      0.484      0.453      0.429      0.256s
GIOU: 11528      30353      0.471      0.441      0.417       1.26s
      11848      30353       0.48       0.45      0.426      0.399s
GIOU: 11848      30353      0.467      0.438      0.414       1.55s
      12168      30353      0.479      0.449      0.426      0.244s
GIOU: 12168      30353      0.466      0.436      0.413       1.46s
      12488      30353      0.477      0.447      0.424      0.279s
GIOU: 12488      30353      0.464      0.434      0.412       1.46s
      12808      30353      0.469      0.439      0.417      0.246s
GIOU: 12808      30353      0.455      0.427      0.405       1.46s
      13128      30353      0.465      0.435      0.414       0.34s
GIOU: 13128      30353      0.451      0.423      0.401        1.6s
      13448      30353      0.466      0.436      0.415      0.399s
GIOU: 13448      30353      0.453      0.424      0.402       1.61s
      13768      30353      0.468      0.436      0.415      0.295s
GIOU: 13768      30353      0.455      0.424      0.403       1.43s
      14088      30353      0.472      0.439      0.418      0.264s
GIOU: 14088      30353      0.458      0.426      0.405       1.42s
      14408      30353      0.467      0.435      0.414      0.371s
GIOU: 14408      30353      0.454      0.423      0.402       1.58s
      14728      30353      0.468      0.437      0.416      0.519s
GIOU: 14728      30353      0.455      0.424      0.404       1.76s
      15048      30353      0.469      0.438      0.418      0.239s
GIOU: 15048      30353      0.456      0.426      0.405       1.45s
      15368      30353      0.472      0.441      0.421      0.326s
GIOU: 15368      30353      0.459      0.429      0.408        1.5s
      15688      30353      0.473      0.442      0.422       0.41s
GIOU: 15688      30353      0.459       0.43      0.409       1.55s
      16008      30353      0.475      0.444      0.424      0.419s
GIOU: 16008      30353       0.46      0.431      0.411       1.61s
      16328      30353       0.48       0.45       0.43      0.446s
GIOU: 16328      30353      0.465      0.436      0.416       1.66s
      16648      30353      0.484      0.455      0.435      0.366s
GIOU: 16648      30353       0.47      0.441      0.422       1.58s
      16968      30353      0.488      0.459       0.44      0.449s
GIOU: 16968      30353      0.474      0.446      0.426       1.54s
      17288      30353      0.491      0.462      0.442      0.243s
GIOU: 17288      30353      0.476      0.448      0.429       1.41s
      17608      30353       0.49      0.462      0.443      0.454s
GIOU: 17608      30353      0.476      0.449       0.43       1.78s
      17928      30353       0.49      0.463      0.445      0.285s
GIOU: 17928      30353      0.476       0.45      0.431       1.53s
      18248      30353       0.49      0.464      0.446      0.425s
GIOU: 18248      30353      0.476       0.45      0.432        1.6s
      18568      30353      0.492      0.466      0.448      0.396s
GIOU: 18568      30353      0.478      0.453      0.435       1.52s
      18888      30353      0.491      0.465      0.447      0.413s
GIOU: 18888      30353      0.477      0.452      0.433        1.7s
      19208      30353      0.495      0.466      0.447      0.314s
GIOU: 19208      30353       0.48      0.452      0.434       1.58s
      19528      30353      0.494      0.465      0.446      0.328s
GIOU: 19528      30353       0.48      0.451      0.433       1.42s
      19848      30353      0.493      0.462      0.444      0.301s
GIOU: 19848      30353      0.478      0.449       0.43       1.46s
      20168      30353      0.491      0.461      0.443      0.326s
GIOU: 20168      30353      0.477      0.448      0.429       1.54s
      20488      30353      0.491      0.463      0.445      0.429s
GIOU: 20488      30353      0.476      0.449      0.431       1.62s
      20808      30353      0.488      0.462      0.443      0.416s
GIOU: 20808      30353      0.474      0.448       0.43       1.53s
      21128      30353      0.487       0.46      0.442      0.465s
GIOU: 21128      30353      0.472      0.447      0.429       1.57s
      21448      30353      0.487      0.461      0.443      0.367s
GIOU: 21448      30353      0.472      0.447      0.429       1.53s
      21768      30353      0.486       0.46      0.443      0.466s
GIOU: 21768      30353      0.471      0.446      0.428       1.75s
      22088      30353      0.484      0.459      0.442      0.214s
GIOU: 22088      30353      0.469      0.445      0.427       1.39s
      22408      30353      0.484      0.459      0.442      0.259s
GIOU: 22408      30353      0.469      0.445      0.428        1.5s
      22728      30353      0.485      0.461      0.444      0.285s
GIOU: 22728      30353      0.471      0.447      0.429       1.47s
      23048      30353      0.487      0.463      0.445      0.418s
GIOU: 23048      30353      0.472      0.449      0.431       1.59s
      23368      30353      0.485      0.461      0.443      0.349s
GIOU: 23368      30353       0.47      0.447      0.429        1.5s
      23688      30353      0.485      0.461      0.443      0.268s
GIOU: 23688      30353       0.47      0.447      0.429       1.32s
      24008      30353      0.486      0.462      0.444      0.451s
GIOU: 24008      30353      0.471      0.448       0.43       1.28s
      24328      30353      0.486      0.462      0.445      0.324s
GIOU: 24328      30353      0.471      0.448       0.43       0.94s
      24648      30353      0.485      0.461      0.444        0.4s
GIOU: 24648      30353       0.47      0.447      0.429      0.878s
      24968      30353      0.482      0.459      0.442      0.647s
GIOU: 24968      30353      0.467      0.445      0.428      0.838s
      25288      30353      0.478      0.457      0.439      0.539s
GIOU: 25288      30353      0.463      0.442      0.425      0.673s
      25608      30353      0.479      0.459      0.442      0.618s
GIOU: 25608      30353      0.465      0.445      0.427      0.646s
      25928      30353      0.481       0.46      0.444      0.555s
GIOU: 25928      30353      0.466      0.446      0.429      0.555s
      26248      30353      0.481      0.461      0.444      0.561s
GIOU: 26248      30353      0.466      0.446      0.429      0.587s
      26568      30353       0.48      0.459      0.443      0.545s
GIOU: 26568      30353      0.465      0.445      0.428      0.545s
      26888      30353      0.481      0.459      0.442      0.401s
GIOU: 26888      30353      0.466      0.445      0.428      0.437s
      27208      30353      0.481      0.459      0.442      0.567s
GIOU: 27208      30353      0.467      0.444      0.428      0.638s
      27528      30353      0.479      0.456       0.44      0.466s
GIOU: 27528      30353      0.465      0.442      0.425      0.547s
      27848      30353      0.479      0.456      0.439      0.279s
GIOU: 27848      30353      0.464      0.441      0.425      0.458s
      28168      30353      0.479      0.454      0.438      0.333s
GIOU: 28168      30353      0.464       0.44      0.424      0.485s
      28488      30353      0.479      0.455      0.439      0.538s
GIOU: 28488      30353      0.464      0.441      0.424      0.717s
      28808      30353      0.481      0.457       0.44      0.499s
GIOU: 28808      30353      0.466      0.443      0.426      0.634s
      29128      30353      0.483      0.458      0.441      0.546s
GIOU: 29128      30353      0.468      0.444      0.427      0.907s
      29448      30353      0.484      0.459      0.442      0.498s
GIOU: 29448      30353      0.469      0.445      0.427      0.743s
      29768      30353      0.483      0.458      0.441      0.435s
GIOU: 29768      30353      0.468      0.444      0.426      0.688s
      30088      30353      0.483      0.457      0.439      0.529s
GIOU: 30088      30353      0.468      0.442      0.424      0.751s
      Image      Total          P          R        mAP
AP: 0.4384


giou_AP: 0.4239


test.test:	 [0.43844816] 	 [0.45625053] 	 [0.483532]
================================================================================
dataset summary
OrderedDict([('caltech', 393.0), ('cuhksysu', 11934.0), ('prw', 934.0)])
total # identities: 13262
start index
OrderedDict([('caltech', 0), ('cuhksysu', 393.0), ('prw', 12327.0)])
================================================================================
Extracting pedestrain features...
Extracting 0/1750, # of instances 16, time 0.48 sec.
Extracting 40/1750, # of instances 740, time 0.40 sec.
Extracting 80/1750, # of instances 1562, time 0.38 sec.
Extracting 120/1750, # of instances 2167, time 0.30 sec.
Extracting 160/1750, # of instances 2625, time 0.46 sec.
Extracting 200/1750, # of instances 3070, time 0.68 sec.
Extracting 240/1750, # of instances 3512, time 0.46 sec.
Extracting 280/1750, # of instances 4168, time 0.38 sec.
Extracting 320/1750, # of instances 4917, time 0.46 sec.
Extracting 360/1750, # of instances 5656, time 0.36 sec.
Extracting 400/1750, # of instances 6192, time 0.44 sec.
Extracting 440/1750, # of instances 6821, time 0.61 sec.
Extracting 480/1750, # of instances 7532, time 0.43 sec.
Extracting 520/1750, # of instances 8106, time 0.61 sec.
Extracting 560/1750, # of instances 8705, time 0.51 sec.
Extracting 600/1750, # of instances 9311, time 0.54 sec.
Extracting 640/1750, # of instances 9821, time 0.40 sec.
Extracting 680/1750, # of instances 10564, time 0.39 sec.
Extracting 720/1750, # of instances 11389, time 0.65 sec.
Extracting 760/1750, # of instances 12637, time 0.70 sec.
Extracting 800/1750, # of instances 13697, time 0.30 sec.
Extracting 840/1750, # of instances 14336, time 0.41 sec.
Extracting 880/1750, # of instances 14954, time 0.55 sec.
Extracting 920/1750, # of instances 15780, time 0.40 sec.
Extracting 960/1750, # of instances 16666, time 0.40 sec.
Extracting 1000/1750, # of instances 17354, time 0.38 sec.
Extracting 1040/1750, # of instances 18131, time 0.68 sec.
Extracting 1080/1750, # of instances 18969, time 0.63 sec.
Extracting 1120/1750, # of instances 19634, time 0.34 sec.
Extracting 1160/1750, # of instances 20204, time 0.49 sec.
Extracting 1200/1750, # of instances 20794, time 0.52 sec.
Extracting 1240/1750, # of instances 21232, time 0.49 sec.
Extracting 1280/1750, # of instances 21920, time 0.73 sec.
Extracting 1320/1750, # of instances 22726, time 0.65 sec.
Extracting 1360/1750, # of instances 23513, time 0.57 sec.
Extracting 1400/1750, # of instances 24322, time 0.73 sec.
Extracting 1440/1750, # of instances 25162, time 0.40 sec.
Extracting 1480/1750, # of instances 25946, time 0.24 sec.
Extracting 1520/1750, # of instances 26804, time 0.58 sec.
Extracting 1560/1750, # of instances 27687, time 0.68 sec.
Extracting 1600/1750, # of instances 28893, time 0.83 sec.
Extracting 1640/1750, # of instances 30190, time 0.41 sec.
Extracting 1680/1750, # of instances 31378, time 0.74 sec.
Extracting 1720/1750, # of instances 32483, time 0.80 sec.
Computing pairwise similairity...
33305 33305
Traceback (most recent call last):
  File "test_mapgiou.py", line 468, in <module>
    opt.print_interval,
  File "test_mapgiou.py", line 220, in test_emb
    pdist = torch.mm(embedding, embedding.t()).cpu().numpy()
RuntimeError: CUDA out of memory. Tried to allocate 4.13 GiB (GPU 0; 10.92 GiB total capacity; 319.90 MiB already allocated; 3.44 GiB free; 144.10 MiB cached)
